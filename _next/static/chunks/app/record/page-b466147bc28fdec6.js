(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{8888:function(e,t,s){Promise.resolve().then(s.bind(s,3951))},7907:function(e,t,s){"use strict";var a=s(5313);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},3951:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return r}});var a=s(3827),n=s(4090),l=s(7907),c=s(5790);function r(){let e=(0,l.useRouter)(),[t,s]=(0,n.useState)([]),[r,i]=(0,n.useState)([]),[d,o]=(0,n.useState)([]),[m,x]=(0,n.useState)([]),[u,h]=(0,n.useState)(null),[p,N]=(0,n.useState)("actor"),[g,j]=(0,n.useState)({}),[f,b]=(0,n.useState)({matchType:"練習",date:new Date().toISOString().split("T")[0],tournamentName:"",opponentName:""}),[y,v]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=(0,c.se)(),t=(0,c.GN)();o(e),x(t)},[]),(0,n.useEffect)(()=>{if(u){let e=setTimeout(()=>{h(null)},2e3);return()=>clearTimeout(e)}},[u]),(0,n.useEffect)(()=>{let e=()=>{if(t.length>0){let e={id:Date.now().toString(),date:f.date,matchType:f.matchType,tournamentName:f.tournamentName,opponentName:f.opponentName,techniques:t,penalties:r,senshu:y};(0,c.jY)(e)}};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e),e()}},[t,r,f,y]);let w=()=>{j({}),N("actor")},k=e=>{j({...g,actor:e}),N("technique")},C=e=>{j({...g,technique:e}),"こかし"===e?N("point"):N("area")},S=e=>{j({...g,area:e}),N("point")},q=e=>{let a={matchId:Date.now().toString(),date:f.date,matchType:f.matchType,tournamentName:f.tournamentName,opponentName:f.opponentName,actor:g.actor,technique:g.technique,area:g.area||"中段",point:e,subTechnique:"こかし"===g.technique?"突き":void 0};s([...t,a]),h({message:"".concat(g.actor,"・").concat(g.area||"").concat(g.technique).concat(e,"点と記録しました"),type:"technique",data:a}),w()},I=(e,t)=>{let s={matchId:Date.now().toString(),actor:e,category:t};i([...r,s]),h({message:"".concat(e,"の").concat(t,"を記録しました"),type:"penalty",data:s})},D=e=>{v(e),h({message:e?"".concat(e,"の先取を記録しました"):"先取なしを記録しました",type:"senshu",data:{actor:e}})},T=e=>t.filter(t=>t.actor===e).reduce((e,t)=>e+t.point,0);return(0,a.jsxs)("div",{className:"space-y-8 fade-in",children:[(0,a.jsx)("div",{className:"glass-card p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCDD"}),(0,a.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"試合記録"})]})}),(0,a.jsx)("div",{className:"glass-card p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-blue-600 mb-2",children:"自分"}),(0,a.jsx)("div",{className:"score-display",children:T("自分")}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-2",children:["反則: C1(",r.filter(e=>"自分"===e.actor&&"カテゴリ1"===e.category).length,") C2(",r.filter(e=>"自分"===e.actor&&"カテゴリ2"===e.category).length,")"]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-600 mb-2",children:"相手"}),(0,a.jsx)("div",{className:"score-display",children:T("相手")}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-2",children:["反則: C1(",r.filter(e=>"相手"===e.actor&&"カテゴリ1"===e.category).length,") C2(",r.filter(e=>"相手"===e.actor&&"カテゴリ2"===e.category).length,")"]})]})]})}),(0,a.jsxs)("div",{className:"glass-card p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"得点の記録"}),"actor"===p&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-center text-gray-600",children:"誰の得点ですか？"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)("button",{onClick:()=>k("自分"),className:"btn-primary py-6 text-xl",children:"自分"}),(0,a.jsx)("button",{onClick:()=>k("相手"),className:"btn-danger py-6 text-xl",children:"相手"})]})]}),"technique"===p&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("p",{className:"text-center text-gray-600",children:[(0,a.jsx)("span",{className:"自分"===g.actor?"text-blue-600":"text-red-600",children:g.actor}),"の技の種類は？"]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsx)("button",{onClick:()=>C("突き"),className:"btn-secondary py-6",children:"突き"}),(0,a.jsx)("button",{onClick:()=>C("蹴り"),className:"btn-secondary py-6",children:"蹴り"}),(0,a.jsx)("button",{onClick:()=>C("こかし"),className:"btn-secondary py-6",children:"こかし"})]}),(0,a.jsx)("button",{onClick:w,className:"btn-secondary w-full",children:"戻る"})]}),"area"===p&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-center text-gray-600",children:"どこに当てましたか？"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)("button",{onClick:()=>S("上段"),className:"btn-secondary py-6",children:"上段"}),(0,a.jsx)("button",{onClick:()=>S("中段"),className:"btn-secondary py-6",children:"中段"})]}),(0,a.jsx)("button",{onClick:w,className:"btn-secondary w-full",children:"戻る"})]}),"point"===p&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-center text-gray-600",children:"何点ですか？"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsx)("button",{onClick:()=>q(1),className:"btn-secondary py-6",children:"1点"}),(0,a.jsx)("button",{onClick:()=>q(2),className:"btn-secondary py-6",children:"2点"}),(0,a.jsx)("button",{onClick:()=>q(3),className:"btn-secondary py-6",children:"3点"})]}),(0,a.jsx)("button",{onClick:w,className:"btn-secondary w-full",children:"戻る"})]})]}),(0,a.jsxs)("div",{className:"glass-card p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"先取"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsx)("button",{onClick:()=>D("自分"),className:"btn-primary py-6 text-xl ".concat("自分"===y?"ring-2 ring-blue-500":""),children:"自分"}),(0,a.jsx)("button",{onClick:()=>D("相手"),className:"btn-danger py-6 text-xl ".concat("相手"===y?"ring-2 ring-red-500":""),children:"相手"}),(0,a.jsx)("button",{onClick:()=>D(null),className:"btn-secondary py-6 text-xl ".concat(null===y?"ring-2 ring-gray-500":""),children:"なし"})]})]}),(0,a.jsxs)("div",{className:"glass-card p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"反則の記録"}),(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-blue-600 mb-2",children:"自分"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("button",{onClick:()=>I("自分","カテゴリ1"),className:"btn-secondary",children:"カテゴリ1"}),(0,a.jsx)("button",{onClick:()=>I("自分","カテゴリ2"),className:"btn-secondary",children:"カテゴリ2"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-red-600 mb-2",children:"相手"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("button",{onClick:()=>I("相手","カテゴリ1"),className:"btn-secondary",children:"カテゴリ1"}),(0,a.jsx)("button",{onClick:()=>I("相手","カテゴリ2"),className:"btn-secondary",children:"カテゴリ2"})]})]})]})})]}),(0,a.jsxs)("div",{className:"glass-card p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"記録済み"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-blue-600 mb-2",children:"自分の技"}),(0,a.jsxs)("div",{className:"space-y-2",children:[t.filter(e=>"自分"===e.actor).map((e,n)=>(0,a.jsxs)("div",{className:"technique-card flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("span",{className:"text-blue-600 font-medium",children:[e.area,e.technique]}),(0,a.jsxs)("span",{className:"text-lg font-bold",children:[e.point,"点"]})]}),(0,a.jsx)("button",{onClick:()=>s(t.filter((e,t)=>t!==n)),className:"text-red-600 hover:text-red-800 font-medium",children:"削除"})]},n)),"自分"===y&&(0,a.jsxs)("div",{className:"technique-card flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-blue-600 font-medium",children:"先取"}),(0,a.jsx)("span",{className:"text-lg font-bold",children:"0.1点"})]}),(0,a.jsx)("button",{onClick:()=>D(null),className:"text-red-600 hover:text-red-800 font-medium",children:"削除"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-red-600 mb-2",children:"相手の技"}),(0,a.jsxs)("div",{className:"space-y-2",children:[t.filter(e=>"相手"===e.actor).map((e,n)=>(0,a.jsxs)("div",{className:"technique-card flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("span",{className:"text-red-600 font-medium",children:[e.area,e.technique]}),(0,a.jsxs)("span",{className:"text-lg font-bold",children:[e.point,"点"]})]}),(0,a.jsx)("button",{onClick:()=>s(t.filter((e,t)=>t!==n)),className:"text-red-600 hover:text-red-800 font-medium",children:"削除"})]},n)),"相手"===y&&(0,a.jsxs)("div",{className:"technique-card flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-red-600 font-medium",children:"先取"}),(0,a.jsx)("span",{className:"text-lg font-bold",children:"0.1点"})]}),(0,a.jsx)("button",{onClick:()=>D(null),className:"text-red-600 hover:text-red-800 font-medium",children:"削除"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-medium mb-2",children:"反則"}),(0,a.jsx)("div",{className:"space-y-2",children:r.map((e,t)=>(0,a.jsxs)("div",{className:"technique-card flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,a.jsx)("div",{className:"flex items-center space-x-3",children:(0,a.jsxs)("span",{className:"font-medium ".concat("自分"===e.actor?"text-blue-600":"text-red-600"),children:[e.actor," - ",e.category]})}),(0,a.jsx)("button",{onClick:()=>i(r.filter((e,s)=>s!==t)),className:"text-red-600 hover:text-red-800 font-medium",children:"削除"})]},t))})]})]})]}),(0,a.jsxs)("div",{className:"glass-card p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"試合情報"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"試合種別"}),(0,a.jsxs)("select",{className:"select-field",value:f.matchType,onChange:e=>b({...f,matchType:e.target.value}),children:[(0,a.jsx)("option",{value:"練習",children:"練習"}),(0,a.jsx)("option",{value:"大会",children:"大会"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"日付"}),(0,a.jsx)("input",{type:"date",className:"input-field",value:f.date,onChange:e=>b({...f,date:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"大会名"}),(0,a.jsx)("input",{type:"text",className:"input-field",value:f.tournamentName,onChange:e=>b({...f,tournamentName:e.target.value}),placeholder:"大会名（任意）",list:"tournaments"}),(0,a.jsx)("datalist",{id:"tournaments",children:m.map((e,t)=>(0,a.jsx)("option",{value:e},t))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"対戦相手"}),(0,a.jsx)("input",{type:"text",className:"input-field",value:f.opponentName,onChange:e=>b({...f,opponentName:e.target.value}),placeholder:"対戦相手名（任意）",list:"opponents"}),(0,a.jsx)("datalist",{id:"opponents",children:d.map((e,t)=>(0,a.jsx)("option",{value:e},t))})]})]})]}),u&&(0,a.jsx)("div",{className:"fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-white shadow-xl rounded-lg p-6 max-w-md w-full mx-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 w-6 h-6 bg-white rotate-45"}),(0,a.jsx)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-lg font-medium",children:u.message}),(0,a.jsx)("button",{onClick:()=>{if(u){if("technique"===u.type){let e=u.data;s(t.filter(t=>t.matchId!==e.matchId))}else if("penalty"===u.type){let e=u.data;i(r.filter(t=>t.matchId!==e.matchId))}else"senshu"===u.type&&v(null);h(null)}},className:"text-red-600 hover:text-red-800 font-medium px-4 py-2 border border-red-600 rounded-lg hover:bg-red-50 transition-colors",children:"取消"})]})})]})}),(0,a.jsx)("div",{className:"glass-card p-6",children:(0,a.jsx)("button",{onClick:()=>{if(0===t.filter(e=>"自分"===e.actor).length){alert("自分の技を少なくとも1つ記録してください。");return}let s={id:Date.now().toString(),date:f.date,matchType:f.matchType,tournamentName:f.tournamentName,opponentName:f.opponentName,techniques:t,penalties:r,senshu:y};(0,c.jY)(s),e.push("/records")},className:"btn-primary w-full py-4 text-xl",children:"保存"})})]})}},5790:function(e,t,s){"use strict";s.d(t,{Fw:function(){return d},GN:function(){return h},GS:function(){return j},_x:function(){return g},bG:function(){return i},c3:function(){return r},jY:function(){return p},k0:function(){return o},se:function(){return x},v:function(){return N}});let a="karate_records",n="karate_user_info",l="karate_opponents",c="karate_tournaments",r=e=>{localStorage.setItem(n,JSON.stringify(e))},i=()=>{let e=localStorage.getItem(n);return e?JSON.parse(e):null},d=e=>{let t=new Date,s=new Date(e),a=t.getFullYear()-s.getFullYear(),n=t.getMonth()-s.getMonth();return(n<0||0===n&&t.getDate()<s.getDate())&&a--,a},o=e=>e<=6?"幼稚園":e<=12?"小学".concat(e-5,"年生"):e<=15?"中学".concat(e-11,"年生"):e<=18?"高校".concat(e-14,"年生"):e<=22?"大学".concat(e-17,"年生"):"一般",m=e=>{if(!e.trim())return;let t=x();t.includes(e)||(t.push(e),localStorage.setItem(l,JSON.stringify(t)))},x=()=>{let e=localStorage.getItem(l);return e?JSON.parse(e):[]},u=e=>{if(!e.trim())return;let t=h();t.includes(e)||(t.push(e),localStorage.setItem(c,JSON.stringify(t)))},h=()=>{let e=localStorage.getItem(c);return e?JSON.parse(e):[]},p=e=>{let t=N();t.push(e),localStorage.setItem(a,JSON.stringify(t)),e.opponentName&&m(e.opponentName),e.tournamentName&&u(e.tournamentName)},N=()=>{let e=localStorage.getItem(a);return e?JSON.parse(e):[]},g=e=>{let t=N().filter(t=>t.id!==e);localStorage.setItem(a,JSON.stringify(t))},j=()=>["試合ID,試合日,試合種別,大会名,対戦相手,技の記録,先取,自分反則カテゴリ1,自分反則カテゴリ2,相手反則カテゴリ1,相手反則カテゴリ2",...N().map(e=>{let t=e.techniques.map(e=>"".concat(e.area).concat(e.technique).concat(e.point,"点").concat(e.actor)).join("、"),s=e.penalties.filter(e=>"自分"===e.actor&&"カテゴリ1"===e.category).length,a=e.penalties.filter(e=>"自分"===e.actor&&"カテゴリ2"===e.category).length,n=e.penalties.filter(e=>"相手"===e.actor&&"カテゴリ1"===e.category).length,l=e.penalties.filter(e=>"相手"===e.actor&&"カテゴリ2"===e.category).length;return[e.id,e.date,e.matchType,e.tournamentName||"",e.opponentName||"",t,e.senshu||"",s,a,n,l]}).map(e=>e.join(","))].join("\n")}},function(e){e.O(0,[971,69,744],function(){return e(e.s=8888)}),_N_E=e.O()}]);