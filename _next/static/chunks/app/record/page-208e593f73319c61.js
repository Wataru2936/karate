(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{8888:function(e,t,a){Promise.resolve().then(a.bind(a,3951))},7907:function(e,t,a){"use strict";var s=a(5313);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},3951:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return r}});var s=a(3827),n=a(4090),c=a(7907),l=a(5790);function r(){let e=(0,c.useRouter)(),[t,a]=(0,n.useState)([]),[r,i]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[m,x]=(0,n.useState)([]),[u,h]=(0,n.useState)(null),[p,g]=(0,n.useState)("actor"),[N,j]=(0,n.useState)({}),[f,b]=(0,n.useState)({matchType:"練習",date:new Date().toISOString().split("T")[0],tournamentName:"",opponentName:""}),[y,v]=(0,n.useState)(null),[C,k]=(0,n.useState)(!1),w=C?"red":"blue",S=C?"blue":"red",[q,I]=(0,n.useState)([]),[D,T]=(0,n.useState)([]);(0,n.useEffect)(()=>{let e=(0,l.se)(),t=(0,l.GN)();d(e),x(t)},[]),(0,n.useEffect)(()=>{I((0,l.GN)().slice(0,5)),T((0,l.se)().slice(0,5))},[]),(0,n.useEffect)(()=>{if(u){let e=setTimeout(()=>{h(null)},2e3);return()=>clearTimeout(e)}},[u]),(0,n.useEffect)(()=>{let e=e=>{let a=P("自分"),s=P("相手");if(a>0||s>0){let e={id:Date.now().toString(),date:f.date,matchType:f.matchType,tournamentName:f.tournamentName,opponentName:f.opponentName,techniques:t,penalties:r,senshu:y,isSwapped:C};(0,l.jY)(e)}else t.length>0&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[t,r,f,y,C]),(0,n.useEffect)(()=>{localStorage.setItem("karate_color_swapped",C.toString())},[C]);let _=()=>{j({}),g("actor")},O=e=>{j({...N,actor:e}),g("technique")},E=e=>{j({...N,technique:e}),"こかし"===e?g("point"):g("area")},J=e=>{j({...N,area:e}),g("point")},M=e=>{let s={matchId:Date.now().toString(),date:f.date,matchType:f.matchType,tournamentName:f.tournamentName,opponentName:f.opponentName,actor:N.actor,technique:N.technique,area:N.area||"中段",point:e,subTechnique:"こかし"===N.technique?"突き":void 0};a([...t,s]),h({message:"".concat(N.actor,"・").concat(N.area||"").concat(N.technique).concat(e,"点と記録しました"),type:"technique",data:s}),_()},G=(e,t)=>{let a={matchId:Date.now().toString(),actor:e,category:t};i([...r,a]),h({message:"".concat(e,"の").concat(t,"を記録しました"),type:"penalty",data:a})},Y=e=>{v(e),h({message:e?"".concat(e,"の先取を記録しました"):"先取なしを記録しました",type:"senshu",data:{actor:e}})},P=e=>t.filter(t=>t.actor===e).reduce((e,t)=>e+t.point,0),R=e=>"自分"===e?w:S,F=e=>"blue"===R(e)?"btn-primary":"btn-danger";return(0,s.jsxs)("div",{className:"space-y-8 fade-in",children:[(0,s.jsxs)("div",{className:"glass-card p-6 flex flex-col md:flex-row md:items-center md:justify-between",children:[(0,s.jsxs)("div",{className:"text-center md:text-left",children:[(0,s.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCDD"}),(0,s.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"試合記録"})]}),(0,s.jsx)("button",{className:"mt-4 md:mt-0 btn-secondary px-6 py-2 text-base",onClick:()=>k(e=>!e),children:"赤と青を入れ替える"})]}),(0,s.jsx)("div",{className:"glass-card p-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-".concat(R("自分"),"-600 mb-2"),children:C?"自分（赤）":"自分（青）"}),(0,s.jsx)("div",{className:"score-display text-".concat(R("自分"),"-600"),children:P("自分")}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 mt-2",children:["反則: C1(",r.filter(e=>"自分"===e.actor&&"C1"===e.category).length,") C2(",r.filter(e=>"自分"===e.actor&&"C2"===e.category).length,")"]})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-".concat(R("相手"),"-600 mb-2"),children:C?"相手（青）":"相手（赤）"}),(0,s.jsx)("div",{className:"score-display text-".concat(R("相手"),"-600"),children:P("相手")}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 mt-2",children:["反則: C1(",r.filter(e=>"相手"===e.actor&&"C1"===e.category).length,") C2(",r.filter(e=>"相手"===e.actor&&"C2"===e.category).length,")"]})]})]})}),(0,s.jsxs)("div",{className:"glass-card p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"得点の記録"}),"actor"===p&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-center text-gray-600",children:"誰の得点ですか？"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)("button",{onClick:()=>O("自分"),className:"".concat(F("自分")," py-6 text-xl"),children:"自分"}),(0,s.jsx)("button",{onClick:()=>O("相手"),className:"".concat(F("相手")," py-6 text-xl"),children:"相手"})]})]}),"technique"===p&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("p",{className:"text-center text-gray-600",children:[(0,s.jsx)("span",{className:"blue"===R(N.actor)?"text-blue-600":"text-red-600",children:N.actor}),"の技の種類は？"]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsx)("button",{onClick:()=>E("突き"),className:"btn-secondary py-6",children:"突き"}),(0,s.jsx)("button",{onClick:()=>E("蹴り"),className:"btn-secondary py-6",children:"蹴り"}),(0,s.jsx)("button",{onClick:()=>E("こかし"),className:"btn-secondary py-6",children:"こかし"})]}),(0,s.jsx)("button",{onClick:_,className:"btn-secondary w-full",children:"戻る"})]}),"area"===p&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-center text-gray-600",children:"どこに当てましたか？"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)("button",{onClick:()=>J("上段"),className:"btn-secondary py-6",children:"上段"}),(0,s.jsx)("button",{onClick:()=>J("中段"),className:"btn-secondary py-6",children:"中段"})]}),(0,s.jsx)("button",{onClick:_,className:"btn-secondary w-full",children:"戻る"})]}),"point"===p&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-center text-gray-600",children:"何点ですか？"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsx)("button",{onClick:()=>M(1),className:"btn-secondary py-6",children:"1点"}),(0,s.jsx)("button",{onClick:()=>M(2),className:"btn-secondary py-6",children:"2点"}),(0,s.jsx)("button",{onClick:()=>M(3),className:"btn-secondary py-6",children:"3点"})]}),(0,s.jsx)("button",{onClick:_,className:"btn-secondary w-full",children:"戻る"})]})]}),(0,s.jsxs)("div",{className:"glass-card p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"先取"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsx)("button",{onClick:()=>Y("自分"),className:"".concat(F("自分")," py-6 text-xl ").concat("自分"===y?"ring-2 ring-blue-500":""),children:"自分"}),(0,s.jsx)("button",{onClick:()=>Y("相手"),className:"".concat(F("相手")," py-6 text-xl ").concat("相手"===y?"ring-2 ring-red-500":""),children:"相手"}),(0,s.jsx)("button",{onClick:()=>Y(null),className:"btn-secondary py-6 text-xl ".concat(null===y?"ring-2 ring-gray-500":""),children:"なし"})]})]}),(0,s.jsxs)("div",{className:"glass-card p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"反則の記録"}),(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-".concat(R("自分"),"-600 mb-2"),children:"自分"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsx)("button",{onClick:()=>G("自分","C1"),className:"btn-secondary",children:"C1"}),(0,s.jsx)("button",{onClick:()=>G("自分","C2"),className:"btn-secondary",children:"C2"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-".concat(R("相手"),"-600 mb-2"),children:"相手"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsx)("button",{onClick:()=>G("相手","C1"),className:"btn-secondary",children:"C1"}),(0,s.jsx)("button",{onClick:()=>G("相手","C2"),className:"btn-secondary",children:"C2"})]})]})]})})]}),(0,s.jsxs)("div",{className:"glass-card p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"記録済み"}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-".concat(R("自分"),"-600 mb-2"),children:"自分の技"}),(0,s.jsxs)("div",{className:"space-y-2",children:[t.filter(e=>"自分"===e.actor).map((e,n)=>(0,s.jsxs)("div",{className:"technique-card flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("span",{className:"font-medium text-".concat(R("自分"),"-600"),children:[e.area,e.technique]}),(0,s.jsxs)("span",{className:"text-lg font-bold",children:[e.point,"点"]})]}),(0,s.jsx)("button",{onClick:()=>a(t.filter((e,t)=>t!==n)),className:"text-red-600 hover:text-red-800 font-medium",children:"削除"})]},n)),"自分"===y&&(0,s.jsxs)("div",{className:"technique-card flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("span",{className:"font-medium text-".concat(R("自分"),"-600"),children:"先取"}),(0,s.jsx)("span",{className:"text-lg font-bold",children:"0.1点"})]}),(0,s.jsx)("button",{onClick:()=>Y(null),className:"text-red-600 hover:text-red-800 font-medium",children:"削除"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-lg font-medium text-".concat(R("相手"),"-600 mb-2"),children:"相手の技"}),(0,s.jsxs)("div",{className:"space-y-2",children:[t.filter(e=>"相手"===e.actor).map((e,n)=>(0,s.jsxs)("div",{className:"technique-card flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("span",{className:"font-medium text-".concat(R("相手"),"-600"),children:[e.area,e.technique]}),(0,s.jsxs)("span",{className:"text-lg font-bold",children:[e.point,"点"]})]}),(0,s.jsx)("button",{onClick:()=>a(t.filter((e,t)=>t!==n)),className:"text-red-600 hover:text-red-800 font-medium",children:"削除"})]},n)),"相手"===y&&(0,s.jsxs)("div",{className:"technique-card flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("span",{className:"font-medium text-".concat(R("相手"),"-600"),children:"先取"}),(0,s.jsx)("span",{className:"text-lg font-bold",children:"0.1点"})]}),(0,s.jsx)("button",{onClick:()=>Y(null),className:"text-red-600 hover:text-red-800 font-medium",children:"削除"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-lg font-medium mb-2",children:"反則"}),(0,s.jsx)("div",{className:"space-y-2",children:r.map((e,t)=>(0,s.jsxs)("div",{className:"technique-card flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("span",{className:"font-medium text-".concat(R(e.actor),"-600"),children:[e.actor," - ",e.category]})}),(0,s.jsx)("button",{onClick:()=>i(r.filter((e,a)=>a!==t)),className:"text-red-600 hover:text-red-800 font-medium",children:"削除"})]},t))})]})]})]}),(0,s.jsxs)("div",{className:"glass-card p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"試合情報"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"試合種別"}),(0,s.jsxs)("div",{className:"flex gap-4 mb-2",children:[(0,s.jsx)("button",{type:"button",className:"btn-secondary px-4 py-2 ".concat("練習"===f.matchType?"ring-2 ring-blue-500":""),onClick:()=>b({...f,matchType:"練習"}),children:"練習"}),(0,s.jsx)("button",{type:"button",className:"btn-secondary px-4 py-2 ".concat("大会"===f.matchType?"ring-2 ring-purple-500":""),onClick:()=>b({...f,matchType:"大会"}),children:"大会"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"日付"}),(0,s.jsx)("input",{type:"date",className:"input-field",value:f.date,onChange:e=>b({...f,date:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"大会名"}),(0,s.jsx)("input",{type:"text",className:"input-field",value:f.tournamentName,onChange:e=>b({...f,tournamentName:e.target.value}),placeholder:"大会名（任意）",list:"tournaments"}),(0,s.jsx)("datalist",{id:"tournaments",children:m.map((e,t)=>(0,s.jsx)("option",{value:e},t))}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:q.map((e,t)=>(0,s.jsx)("button",{type:"button",className:"btn-secondary px-3 py-1 text-sm",onClick:()=>b({...f,tournamentName:e}),children:e},t))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"対戦相手"}),(0,s.jsx)("input",{type:"text",className:"input-field",value:f.opponentName,onChange:e=>b({...f,opponentName:e.target.value}),placeholder:"対戦相手名（任意）",list:"opponents"}),(0,s.jsx)("datalist",{id:"opponents",children:o.map((e,t)=>(0,s.jsx)("option",{value:e},t))}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:D.map((e,t)=>(0,s.jsx)("button",{type:"button",className:"btn-secondary px-3 py-1 text-sm",onClick:()=>b({...f,opponentName:e}),children:e},t))})]})]})]}),u&&(0,s.jsx)("div",{className:"fixed bottom-8 left-1/2 transform -translate-x-1/2 shadow-xl rounded-lg p-6 max-w-md w-full mx-4",children:(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("div",{className:"rounded-lg p-4 border border-gray-200",style:{backgroundColor:u.data&&"自分"===u.data.actor?"blue"===w?"rgba(59,130,246,0.7)":"rgba(239,68,68,0.7)":u.data&&"相手"===u.data.actor?"blue"===S?"rgba(59,130,246,0.7)":"rgba(239,68,68,0.7)":"rgba(107,114,128,0.7)"},children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-lg font-medium text-white",children:u.message}),(0,s.jsx)("button",{onClick:()=>{if(u){if("technique"===u.type){let e=u.data;a(t.filter(t=>t.matchId!==e.matchId))}else if("penalty"===u.type){let e=u.data;i(r.filter(t=>t.matchId!==e.matchId))}else"senshu"===u.type&&v(null);h(null)}},className:"text-white hover:text-gray-200 font-medium px-4 py-2 border border-white rounded-lg hover:bg-white/20 transition-colors",children:"取消"})]})})})}),(0,s.jsx)("div",{className:"glass-card p-6",children:(0,s.jsx)("button",{onClick:()=>{let a=P("自分"),s=P("相手");if(0===a&&0===s){alert("自分または相手の技を少なくとも1つ記録してください。");return}let n={id:Date.now().toString(),date:f.date,matchType:f.matchType,tournamentName:f.tournamentName,opponentName:f.opponentName,techniques:t,penalties:r,senshu:y,isSwapped:C};(0,l.jY)(n),e.push("/records")},className:"btn-primary w-full py-4 text-xl",children:"保存"})})]})}},5790:function(e,t,a){"use strict";a.d(t,{Fw:function(){return o},GN:function(){return h},GS:function(){return j},_x:function(){return N},bG:function(){return i},c3:function(){return r},jY:function(){return p},k0:function(){return d},se:function(){return x},v:function(){return g}});let s="karate_records",n="karate_user_info",c="karate_opponents",l="karate_tournaments",r=e=>{localStorage.setItem(n,JSON.stringify(e))},i=()=>{let e=localStorage.getItem(n);return e?JSON.parse(e):null},o=e=>{let t=new Date,a=new Date(e),s=t.getFullYear()-a.getFullYear(),n=t.getMonth()-a.getMonth();return(n<0||0===n&&t.getDate()<a.getDate())&&s--,s},d=e=>e<=6?"幼稚園":e<=12?"小学".concat(Math.min(e-5,6),"年生"):e<=15?"中学".concat(Math.min(e-11,3),"年生"):e<=18?"高校".concat(Math.min(e-14,3),"年生"):e<=22?"大学".concat(Math.min(e-17,4),"年生"):"一般",m=e=>{if(!e.trim())return;let t=x().filter(t=>t!==e);t.unshift(e),t.length>20&&(t=t.slice(0,20)),localStorage.setItem(c,JSON.stringify(t))},x=()=>{let e=localStorage.getItem(c);return e?JSON.parse(e):[]},u=e=>{if(!e.trim())return;let t=h().filter(t=>t!==e);t.unshift(e),t.length>20&&(t=t.slice(0,20)),localStorage.setItem(l,JSON.stringify(t))},h=()=>{let e=localStorage.getItem(l);return e?JSON.parse(e):[]},p=e=>{let t=g();t.push(e),localStorage.setItem(s,JSON.stringify(t)),e.opponentName&&m(e.opponentName),e.tournamentName&&u(e.tournamentName)},g=()=>{let e=localStorage.getItem(s);return e?JSON.parse(e):[]},N=e=>{let t=g().filter(t=>t.id!==e);localStorage.setItem(s,JSON.stringify(t))},j=()=>["試合ID,試合日,試合種別,大会名,対戦相手,技の記録,先取,自分反則C1,自分反則C2,相手反則C1,相手反則C2",...g().map(e=>{let t=e.techniques.map(e=>"".concat(e.area).concat(e.technique).concat(e.point,"点").concat(e.actor)).join("、"),a=e.penalties.filter(e=>"自分"===e.actor&&"C1"===e.category).length,s=e.penalties.filter(e=>"自分"===e.actor&&"C2"===e.category).length,n=e.penalties.filter(e=>"相手"===e.actor&&"C1"===e.category).length,c=e.penalties.filter(e=>"相手"===e.actor&&"C2"===e.category).length;return[e.id,e.date,e.matchType,e.tournamentName||"",e.opponentName||"",t,e.senshu||"",a,s,n,c]}).map(e=>e.join(","))].join("\n")}},function(e){e.O(0,[971,69,744],function(){return e(e.s=8888)}),_N_E=e.O()}]);